<div class="main-wrapper">
  <app-menu></app-menu>

  <div class="page-wrapper bg-wrapper">
       <div class="content">

        <div class="card shadow-sm border-0 p-3 m-2" style="border-radius: 12px;">
  <!-- Header Row -->
  <div class="row align-items-center mb-3">
    <div class="col-md-6 col-12 text-center text-md-start mb-2 mb-md-0">
      <p-tag icon="pi pi-sitemap" severity="success" value="My Genealogy" [rounded]="true"></p-tag>
    </div>
  </div>

  <!-- Team Info -->

  <div class="row text-center g-3 d-none d-md-flex">
  <div class="col-6 col-sm-4 col-md-2">
    <img src="assets/free.png" alt="Free User" width="50" height="50">
    <h6 class="mt-2">Free User</h6>
  </div>
  <div class="col-6 col-sm-4 col-md-2">
    <img src="assets/silver.jpg" alt="Subscribed" height="50">
    <h6 class="mt-2">Subscribed</h6>
  </div>
 
  <div class="col-6 col-sm-4 col-md-2">
    <img src="assets/logo.png" alt="Default" height="50">
    <h6 class="mt-2">Default</h6>
  </div>
</div>

<div class="row d-lg-none">
    <!-- Sticky Left Sidebar -->
<div class="sticky-sidebar">
  <a href="#" class="icon-item" title="Free User">
    <img src="assets/free.png" alt="Free User">
    <span>Free</span>
  </a>

  <a href="#" class="icon-item" title="Subscribed">
    <img src="assets/silver.jpg" alt="Subscribed">
    <span>Subscribed</span>
  </a>

  <a href="#" class="icon-item" title="Default">
    <img src="assets/logo.png" alt="Default">
    <span>Default</span>
  </a>
</div>


</div>


  <!-- Search Section -->
  <div class="mt-4">
    <label class="form-label fw-bold text-primary">Search User ID</label>
    <div class="d-flex flex-wrap gap-2">
      <input type="text" pInputText [(ngModel)]="udata.regid" 
             placeholder="Enter User ID" 
             class="flex-grow-1 p-inputtext-sm form-control" />
      <button class="btn btn-sm btn-danger" (click)="mytree1(udata.regid)">
        <i class="pi pi-search"></i> Submit
      </button>
    </div>
  </div>
</div>
<!-- nhh -->

 <div class="card shadow-sm p-3 mt-4">
    <label class="form-label fw-bold text-primary">{{data2?.main.regid}} ({{data2?.main.name}})</label>
    <div class="d-flex flex-wrap gap-2">
           <table class="table table-bordered align-middle text-center">
            <thead class="table-light">
              <tr>
                <th> </th>
                <th>Left</th>
                <th>Right</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="fw-bold text-primary">Team</td>
                <td>{{ data2?.mleft || 0 }}</td>
                <td>{{ data2?.mright || 0 }}</td>
              </tr>
              <tr>
                <td class="fw-bold text-secondary">Business</td>
                <td>{{ data2?.mleftbusiness || 0 | currency:'USD':true:'1.0-2' }}</td>
                <td>{{ data2?.mrightbusiness || 0 | currency:'USD':true:'1.0-2' }}</td>
              </tr>
            </tbody>
          </table> 
    </div>
  </div>
</div>


<div class="card flex justify-content-center overflow-x-auto p-2">

   <div *ngIf="errorMessage" class="error-message">
     <span class="text-danger text-center">{{ errorMessage }}</span>
 </div>
 <div class="container mt-2">
    <div class="tree-back-btn">
    <button (click)="goBack()" class="btn btn-sm btn-primary">
      <i class="pi pi-arrow-left"></i> Back
    </button>
   

   <i class="fa fa-print mx-5"
   style="cursor: pointer; font-size: 28px; color:#007bff"
   (click)="printTable()">
</i>
 <i class="fa fa-download mx-5 mt-1"
     style="cursor: pointer; font-size: 30px; color:green"
     (click)="downloadPDF()"></i>

<!-- Organization Chart -->
<!-- ORG CHART -->
<div id="orgChartToPrint">
  <p-organizationChart [value]="data" styleClass="responsive-org-chart">
    <ng-template let-node pTemplate="person">
      <div class="text-center node-container" style="cursor: pointer;">
        <img
          [src]="node.data.image" (click)="handleNodeClick(node.data)"
          class="node-image mb-2 rounded-circle shadow-sm"
          width="80"
          height="80"
          alt="User"
        />
        <div class="font-bold node-name mt-2">
          <span class="text-success" 
          (click)="showNodeModal(node.data)">{{ node.data.name }}</span>
        </div>
        <div class="node-title">
          <span class="text-primary">{{ node.data.title }}</span>
        </div>
      </div>
    </ng-template>
  </p-organizationChart>
</div>

 </div>
 
 <div class="">
   
<!-- BOOTSTRAP MODAL -->
<div
  class="modal fade"
  #nodeModal
  tabindex="-1"
  aria-labelledby="nodeModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content shadow-lg border-0 rounded-4">
      <div class="modal-header bg-primary text-white rounded-top-4">
        <h5 class="modal-title fw-bold" id="nodeModalLabel">Member Details</h5>
        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>

      <!-- Loader -->
      <div *ngIf="loading" class="modal-body text-center py-4">
        <div class="spinner-border text-primary" role="status"></div>
        <p class="mt-3 text-muted">Loading data, please wait...</p>
      </div>

      <!-- Content -->
      <div *ngIf="!loading && repd" class="modal-body">
        <div class="text-center">
          <img
            [src]="repd.image || 'assets/default-user.png'"
            class="rounded-circle border border-3 shadow-sm mb-3"
            width="100"
            height="100"
            alt="Profile"
          />
          <h4 class="fw-bold">{{ repd.name }}</h4>
          <p class="text-muted mb-0">{{ repd.title }}</p>
        </div>

        <div class="table-responsive mt-4">
          <table class="table table-bordered align-middle text-center">
            <thead class="table-light">
              <tr>
                <th></th>
                <th>Left</th>
                <th>Right</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="fw-bold text-primary">Team</td>
                <td>{{ tdata?.mleft || 0 }}</td>
                <td>{{ tdata?.mright || 0 }}</td>
              </tr>
               <tr>
                <td class="fw-bold text-secondary">Business</td>
                <td>{{ tdata?.mleftbusiness || 0 | currency:'USD':true:'1.0-2' }}</td>
                <td>{{ tdata?.mrightbusiness || 0 | currency:'USD':true:'1.0-2' }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="modal-footer border-0">
        <button
          type="button"
          class="btn btn-outline-secondary"
          data-bs-dismiss="modal"
        >
          Close
        </button>
      </div>
    </div>
  </div>
</div>
 </div>
 
 
 
   
 </div>




        </div>
    </div>


 </div>