<app-menu-bar></app-menu-bar>

<div class="page-wrapper bg-wrapper">
    <div class="content" style="margin-top: -50px;">
      <form [formGroup]="form" novalidate>
         <div class="row">
            <div class="col-md-12 ">
                <div class="card p-2 buy-form">
                    <h4 class="page-title text-danger" *ngFor="let row of data2">Withdraw Wallet <span class="badge badge-success"> Wallet: {{row.walletamount | currency:'USD':true:'1.0-1'}}</span> </h4>
                    <div class="row">
                     <p class="text-danger text-center" *ngIf="errorMessage">{{ errorMessage }}</p>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="focus-label">Enter Amount ($)*</label>
                                <input type="text" class="form-control floating" formControlName="amount">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="focus-label">Security Key * <span ngbTooltip="This Security Key Check your profile">
                                                            <i class="fa fa-exclamation-circle"></i>
                                                          </span></label>
                                <input type="text" class="form-control floating" formControlName="transactionpassword">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group" *ngFor="let row1 of data2">
                                <label class="focus-label">Wallet Address</label>
                                <input type="text" class="form-control floating" placeholder="{{row1.wallet1}}" readonly>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="focus-label">Remark *</label>
                                <input type="text" class="form-control floating" formControlName="note">
                            </div>
                        </div>
                        <div class="text-center m-t-10" *ngFor="let row2 of data2">
                            <button class="btn btn-primary submit-btn" (click)="openConfirmModal()" [disabled]="!form.valid" type="button" *ngIf="row2.wallet1 !== ''">Withdraw</button>
                             <button  type="button" class="btn btn-primary submit-btn" routerLink="/myprofile" *ngIf="row2.wallet1 === '' ">Update Wallet Address</button>
                        </div>
                    </div>
                </div>
            </div>
         </div>
      </form>
        <div class="row">
            
            <div class="col-md-12 mt-2">
                <div class="text-center mb-3 d-flex flex-wrap justify-content-center">
                  <button class="btn btn-outline-primary m-1" (click)="showSection('pending')">Pending</button>
                    <button class="btn btn-outline-success m-1" (click)="showSection('report')">Wallet Report</button>
                </div>
            </div>

            <div class="col-md-12 " *ngIf="pending">
                <div class="col-md-12">
                    <div class="buy-form">
                        <div class="row">
                            <!-- Rows per page selector -->
                                <div class="col-md-6">
                                    <h4 class="page-title text-danger">Pending Withdraw</h4>
                                </div>
                          </div>
                  
                      <!-- Table -->
                      <div class="table-responsive">
                        <table class="table table-striped custom-table mb-0">
                          <thead>
                            <tr>
                              <th>S.No</th>
                              <th>Date</th>
                              <th>Amount</th>
                              <th>Remark</th>
                              <th>Status</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let item of pdata; let i = index">
                              <td>{{ i + 1 }}</td>
                              <td>{{ item.cdate | date:'dd/MM/YYYY' }}</td>
                              <td>{{ item.netamount | currency:'USD':true:'1.0-1' }}</td>
                              <td>{{ item.note }}</td>
                              <td>
                                <span class="badge badge-success" *ngIf="item.status==='1'">Paid</span> <span class="badge badge-danger" *ngIf="item.status==='0'">Pending</span>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                  
                    </div>
                  </div>
            </div>

            <div class="col-md-12 " *ngIf="report">
                <app-wallet-report></app-wallet-report>
            </div>

        </div>
    </div>
</div>

<ng-template #withdrawModal let-modal>
  <div class="modal-header bg-success text-white position-relative">
    <h5 class="modal-title">
      <i class="fa fa-check-circle"></i> Withdraw Successful!
    </h5>
    <button type="button" class="close text-white" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
    <div class="fireworks-bg"></div>
  </div>

  <div class="modal-body text-center py-4" *ngFor="let rdata of data2">
      <img [src]="rdata.image || 'assets/logo.png'" (error)="onImageError($event)" alt="Profile Image" class="img-fluid mb-3"     style="max-height:150px;" 
  />
    <h4 class="text-success font-weight-bold">Your Withdraw Is Successful!</h4>
     <p class="mb-2"><strong>Date:</strong> {{ udata?.cdate | date:'dd/MM/YYYY' }}</p>
    <p class="mb-2"><strong>Name:</strong> {{ rdata?.name }}</p>
     <p class="mb-2"><strong>User ID:</strong> {{ rdata?.regid }}</p>
    <p class="mb-3 text-success"><strong>Amount:</strong> {{ udata?.amount }}</p>
    <p class="text-primary font-italic">
      Letâ€™s start fulfilling your dream with <strong class="text-danger">IconiStar</strong> ðŸŒŸ
    </p>
  </div>

  <div class="modal-footer justify-content-center">
    <button type="button" class="btn btn-success px-4" (click)="modal.close('Close click')">
      Letâ€™s Go!
    </button>
  </div>
</ng-template>


<!-- Confirm Modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="confirmModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content border-0 shadow">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="confirmModalLabel">Confirm Action</h5>
          <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body text-center">
          <p>Are you sure you want to confirm this action?</p>
        </div>
        <div class="modal-footer justify-content-center">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
          <button type="button" class="btn btn-success" (click)="confirmAction()">Yes, Confirm</button>
        </div>
      </div>
    </div>
  </div>
  